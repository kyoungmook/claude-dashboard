<!-- Active Teams -->
{% if active_teams %}
<div class="mb-8">
  <h2 class="text-lg font-semibold mb-4">활성 팀</h2>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    {% for team in active_teams %}
    <div class="bg-gray-800 rounded-lg p-5 border border-blue-700">
      <h3 class="font-semibold text-blue-400 text-lg mb-3">{{ team.team_name }}</h3>
      <div class="space-y-2">
        {% for member in team.members %}
        <div class="flex items-center gap-2 text-sm">
          <span class="w-2 h-2 bg-green-400 rounded-full"></span>
          <span class="text-gray-200">{{ member.name }}</span>
          <span class="text-xs text-gray-500">({{ member.agent_type }})</span>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endif %}

<!-- Task Lists -->
{% if task_lists %}
<div class="space-y-4 mb-4">
  {% for tl in task_lists %}
  {% set completed = tl.tasks | selectattr("status", "equalto", "completed") | list | length %}
  {% set in_progress = tl.tasks | selectattr("status", "equalto", "in_progress") | list | length %}
  {% set total = tl.tasks | length %}
  {% set pct = ((completed / total) * 100) | int if total > 0 else 0 %}
  <div class="bg-gray-800 rounded-lg p-5 border border-gray-700">
    <div class="flex items-center justify-between mb-3">
      <div class="flex items-center gap-3">
        <h3 class="font-mono text-sm text-gray-400">{{ tl.list_id[:8] }}...</h3>
        <span class="text-xs text-gray-500">{{ completed }}/{{ total }} 완료</span>
        {% if in_progress > 0 %}
        <span class="text-xs text-yellow-400">{{ in_progress }}개 진행 중</span>
        {% endif %}
      </div>
      <span class="text-xs text-gray-500">{{ tl.last_modified }}</span>
    </div>

    <!-- Progress bar -->
    <div class="w-full bg-gray-700 rounded-full h-2 mb-4">
      <div class="bg-green-500 h-2 rounded-full transition-all" style="width: {{ pct }}%"></div>
    </div>

    <!-- Tasks -->
    <div class="space-y-1.5">
      {% for task in tl.tasks %}
      <div class="flex items-start gap-2 py-1 px-2 rounded hover:bg-gray-750">
        {% if task.status == "completed" %}
        <span class="text-green-400 mt-0.5" title="완료">&#10003;</span>
        {% elif task.status == "in_progress" %}
        <span class="text-yellow-400 mt-0.5 animate-pulse" title="진행 중">&#9679;</span>
        {% else %}
        <span class="text-gray-500 mt-0.5" title="대기">&#9675;</span>
        {% endif %}
        <div class="flex-1 min-w-0">
          <span class="text-sm {% if task.status == 'completed' %}text-gray-400 line-through{% elif task.status == 'in_progress' %}text-yellow-200{% else %}text-gray-300{% endif %}">
            {{ task.subject }}
          </span>
          {% if task.status == "in_progress" and task.active_form %}
          <div class="text-xs text-yellow-400/70 mt-0.5">{{ task.active_form }}</div>
          {% endif %}
          {% if task.description %}
          <div class="text-xs text-gray-500 mt-0.5 truncate">{{ task.description }}</div>
          {% endif %}
        </div>
        <span class="text-xs text-gray-600 font-mono">#{{ task.id }}</span>
      </div>
      {% endfor %}
    </div>
  </div>
  {% endfor %}
</div>
{% else %}
<div class="bg-gray-800 rounded-lg p-12 border border-gray-700 text-center">
  <div class="text-gray-500 text-lg mb-2">태스크 리스트가 없습니다</div>
  <div class="text-gray-600 text-sm">Claude Code에서 TaskCreate로 태스크를 생성하면 여기에 표시됩니다</div>
</div>
{% endif %}

<div class="text-right text-xs text-gray-500">갱신: {{ updated_at }}</div>
